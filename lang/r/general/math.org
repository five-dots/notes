#+STARTUP: folded indent inlineimages latexpreview
#+PROPERTY: header-args:R :session *R:math* :width 560 :height 420 :results output

* ä»£è¡¨å€¤

- ç®—è¡“å¹³å‡
$\frac{1}{n} \Sigma_{i=1}^n$

#+begin_src R
x <- c(1, 3, 7, 7, 12, 20)
sum(x)/length(x)
mean(x)
#+end_src

#+RESULTS:
: [1] 8.333333
: [1] 8.333333

- å¹¾ä½•å¹³å‡
$(\Pi_{i=1}^n a_i)^{1/n}$

#+begin_src R
prod(x)^(1/length(x))
#+end_src

#+RESULTS:
: [1] 5.726924

- èª¿å’Œå¹³å‡ (ç‡ã®å¹³å‡)
#+begin_src R
length(x)/sum(1/x)
#+end_src

#+RESULTS:
: [1] 3.423913

- ä¸­å¤®å€¤
#+begin_src R
median(x)
#+end_src

#+RESULTS:
: 7

- æœ€é »å€¤
#+begin_src R
names(which.max(table(x)))
#+end_src

#+RESULTS:
: [1] "7"

- æœ€å¤§ãƒ»æœ€å°
#+begin_src R
min(x)
max(x)
#+end_src

#+RESULTS:
: [1] 1
: 
: [1] 20

* æ•£å¸ƒåº¦
** åˆ†æ•£

- åå·®ã® 2 ä¹—ã®å¹³å‡
- æ¨™æœ¬åˆ†æ•£
  - æ¨™æœ¬åˆ†æ•£ã¯ _ä¸€è‡´æ¨å®šé‡_ ã§ã¯ã‚ã‚‹ã‚‚ã®ã® _ä¸åæ¨å®šé‡_ ã§ã¯ãªã„
  - n ãŒååˆ†ã«å¤§ãããªã„å ´åˆã«ã¯æ¨™æœ¬åˆ†æ•£ã®æœŸå¾…å€¤ã¯æ¯åˆ†æ•£ã«ä¸€è‡´ã›ãšã€æ¯åˆ†æ•£ã‚ˆã‚Šå°ã•ããªã‚‹

$\hat{\sigma^2} = \frac{1}{n}\sum_{i=1}^n(x_i - \bar{x})^2$

#+begin_src R
mean((x - mean(x))^2)
#+end_src

#+RESULTS:
: [1] 39.22222
: [1] 39.22222


- ä¸ååˆ†æ•£ (Unbiased Variance) (= ä¸åæ¨å®šé‡)
  - ã‚µãƒ³ãƒ—ãƒ«æ•°ã‚’ n-1 ã™ã‚‹
  - ä¸åæ€§(= æ¯é›†å›£ã®åˆ†æ•£ã¨ä¸€è‡´ã™ã‚‹ã“ã¨) ã‚’æº€ãŸã™

$s^2 = \frac{1}{n-1}\sum_{i=1}^n(x_i - \bar{x})^2$

#+begin_src R
sum((x - mean(x))^2) / (length(x) - 1)
var(x)
#+end_src

#+RESULTS:
: [1] 47.06667
: [1] 47.06667

- ãªãœ n-1 ã™ã‚‹ã¨ä¸åæ¨å®šé‡ã«ãªã‚‹ã®ã‹ï¼Ÿ
  - ã€é‡‘èå¸‚å ´ã®ãŸã‚ã®çµ±è¨ˆå­¦ã€p.30-31
  - åˆ†æ•£ã‚’æ±‚ã‚ã‚‹ãŸã‚ã®åå·®ã¯ã€å…¨ã¦åˆè¨ˆã™ã‚‹ã¨ã‚¼ãƒ­ã«ãªã‚‹
  $(x_1 - \bar{x}) + (x_2 - \bar{x}) + \dots + (x_n - \bar{x}) = 0$
  - _ã¤ã¾ã‚Šã€æœ€å¾Œã®ãƒ‡ãƒ¼ã‚¿ã¯ã€ã‹ãªã‚‰ãšå’ŒãŒã‚¼ãƒ­ã«ãªã‚‹ã‚ˆã†ã«è‡ªå‹•çš„ã«æ±ºã¾ã£ã¦ã—ã¾ã†_
  - ãã®ãŸã‚ã€ãƒ‡ãƒ¼ã‚¿æ•° n ã®ä¸­ã§ 1 ã¤ã¯ã€ã€Œè‡ªç”±ã«æ•£ã‚‰ã°ã‚‹ã“ã¨ãŒã§ããªã„ã€
  - ã“ã‚Œã‚’è‡ªç”±åº¦ãŒ 1 ã¤æ¸›ã‚‹ã¨ã„ã†
  - n-1 ã™ã‚‹ã“ã¨ã§ã€æ¯åˆ†æ•£ã‚’éå°ã«è©•ä¾¡ã—ã¦ã—ã¾ã†ã“ã¨ã‚’é¿ã‘ã¦ã„ã‚‹

** æ¨™æº–åå·®
åå·®ã® 2 ä¹—ã®å¹³å‡ã®å¹³æ–¹æ ¹

- æ¨™æº–åå·®
#+begin_src R
sqrt(var(x))
sd(x)
#+end_src

#+RESULTS:
: [1] 6.860515
: 
: [1] 6.860515

** å¹³å‡åå·®
åå·®ã®çµ¶å¯¾å€¤ã®å¹³å‡

#+begin_src R
mean(abs(x - mean(x)))
#+end_src

#+RESULTS:
: [1] 5.111111

** ç¯„å›²(ãƒ¬ãƒ³ã‚¸)

#+begin_src R
max(x) - min(x)
#+end_src

#+RESULTS:
: [1] 19
* z å€¤

- åå·®ã‚’æ¨™æº–åå·®ã§å‰²ã£ã¦ã€æ¨™æº–åŒ–ã—ãŸã‚‚ã®
- ã°ã‚‰ã¤ãã®å…·åˆã‚’æ­£è¦åŒ–ã§ãã‚‹

#+begin_src R
(x - mean(x)) / sd(x)
#+end_src

#+RESULTS:
: [1] -1.0689188 -0.7773955 -0.1943489 -0.1943489  0.5344594  1.7005526

* ç›¸é–¢
** å…±åˆ†æ•£

- å…±åˆ†æ•£ (ä¸åå…±åˆ†æ•£)
- 2 ã¤ã®ãƒ‡ãƒ¼ã‚¿é–“åå·®åŒå£«ã®ç©ã®å¹³å‡
- æ­£ãªã‚‰ã°åŒã˜æ–¹å‘ã«å‹•ãã€è² ãªã‚‰ã°é€†ã®æ–¹å‘ã«å‹•ã

#+begin_src R
y <- c(-29, -9, -8, -5, -3, 1)

sum((x - mean(x)) * (y - mean(y))) / (length(x) - 1)
cov(x, y)
#+end_src

#+RESULTS:
: [1] 55.73333
: [1] 55.73333

** ç›¸é–¢ä¿‚æ•°

- å…±åˆ†æ•£ã‚’ 2 ã¤ã®ãƒ‡ãƒ¼ã‚¿ã®æ¨™æº–åå·®ã§å‰²ã£ã¦æ­£è¦åŒ–ã—ãŸã®ã‚‚ã®
- ãƒ‡ãƒ¼ã‚¿ã®å˜ä½ã®å½±éŸ¿ã‚’æ¶ˆã™ã“ã¨ãŒã§ãã‚‹
#+begin_src R
cov(x, y) / (sd(x) * sd(y))
cor(x, y)
#+end_src

#+RESULTS:
: [1] 0.7725849
: [1] 0.7725849

- 0-1 ã® 2 å€¤ãƒ‡ãƒ¼ã‚¿ã®ç›¸é–¢ä¿‚æ•°ã¯ã€ãƒ•ã‚¡ã‚¤ä¿‚æ•°ã¨å‘¼ã°ã‚Œã‚‹
#+begin_src R
cor(c(0, 1, 1, 0, 1), c(0, 0, 1, 1, 1))
#+end_src

#+RESULTS:
: [1] 0.1666667
** åˆ†æ•£å…±åˆ†æ•£è¡Œåˆ—

- å¤šå¤‰é‡é–“ã®åˆ†æ•£ãƒ»å…±åˆ†æ•£ã‚’è¡Œåˆ—ã«ã¾ã¨ã‚ãŸã‚‚ã®
- å¯¾è§’ãŒã€ãã‚Œãã‚Œã®å¤‰æ•°ã®åˆ†æ•£
#+begin_src R
v1 <- c(1, 3, 9, 12, 15)
v2 <- c(-15, -12, -9, -3, -1)
v3 <- c(14, -33, 0, 93, 2)

mat <- matrix(c(v1, v2, v3), ncol =3)
mat
cov(mat)
var(v1)
var(v2)
var(v3)

cov(v1, v2)
cov(v1, v3)
#+end_src

#+RESULTS:
#+begin_example
     [,1] [,2] [,3]
[1,]    1  -15   14
[2,]    3  -12  -33
[3,]    9   -9    0
[4,]   12   -3   93
[5,]   15   -1    2
       [,1]   [,2]    [,3]
[1,]  35.00  34.25  113.25
[2,]  34.25  35.00  128.25
[3,] 113.25 128.25 2195.70
[1] 35
[1] 35
[1] 2195.7
[1] 34.25
[1] 113.25
#+end_example
* å¯¾æ•°/æŒ‡æ•°
** è‡ªç„¶å¯¾æ•°

- 2.718 ã‚’ä½•ä¹—ã—ãŸã‚‰ãã®æ•°ã«ãªã‚‹ã‹
#+begin_src R
log(10, base = exp(1)) # åº• = e
exp(1)
#+end_src

#+RESULTS:
: [1] 2.302585
: 
: [1] 2.718282

- å¯¾æ•° => æŒ‡æ•°
#+begin_src R
log(20) # = 2.99... ã¤ã¾ã‚Š 20(çœŸæ•°) = 2.7(åº•) ^ 3(å¯¾æ•°) ã¨ã„ã†ã“ã¨
exp(3)  # åº• e * n
#+end_src

#+RESULTS:
: [1] 2.995732
: 
: [1] 20.08554

- æŒ‡æ•° => å¯¾æ•°
#+begin_src R
ans <- exp(10)
ans
log(ans)
#+end_src

#+RESULTS:
: 
: [1] 22026.47
: 
: [1] 10

- çœŸæ•° > 0 ã§ãªã‘ã‚Œã°ãªã‚‰ãªã„
#+begin_src R
log(0)
log(-1)
#+end_src

#+RESULTS:
: [1] -Inf
: 
: [1] NaN
: Warning message:
: In log(-1) : NaNs produced

- çœŸæ•° < 1 ã¯è² ã®æ•°
#+begin_src R
log(0.9) # => -0.105..
log(1)   # => 0
log(1.1) # => 0.095..
#+end_src

#+RESULTS:
: [1] -0.1053605
: 
: [1] 0
: 
: [1] 0.09531018

#+begin_src R
n <- 100
ans <- log(n)
dplyr::near(exp(ans), n)
#+end_src

#+RESULTS:
: 
: [1] TRUE

** å¸¸ç”¨å¯¾æ•°
log10()

** Binary logarithims

- log2()

** log_sum_exp() & softmax

$log(\Sigma_{i=1}^n c_i exp(x_i))$

- [[https://scrapbox.io/kimiyuki/logsumexp][logsumexp@æœªæ¥ã®è‡ªåˆ†ãŒèª­ã‚€ãƒ¡ãƒ¢]]
- é€šå¸¸ã€ã‚µãƒ³ãƒ—ãƒ«ã®å°¤åº¦ã¯ãƒ‡ãƒ¼ã‚¿ç‚¹ã®å¯†åº¦é–¢æ•°ã®æ›ã‘ç®—ãªã®ã§ã€å¯¾æ•°å°¤åº¦ã«ã—ã¦ã€å’Œã®å½¢ã§è¶³ã—è¾¼ã‚€ã¨ãªã‚‹
- æ··åˆåˆ†å¸ƒãªã©ã®å ´åˆã¯å¯†åº¦é–¢æ•°è‡ªä½“ã«å’Œã®å½¢ãŒå…¥ã‚‹ã®ã§ã€å¯¾æ•°ã‚’ã¨ã£ã¦ã‚‚ã€ãƒãƒ©ã™ã“ã¨ãŒã§ããªã„
- ã‚ã¨ã€è¨ˆç®—æ©Ÿã®å•é¡Œã‚‚ã‚ã‚‹ã€‚
- å˜ç´”ã« x ã‚’ exp ã—ãŸããªã„å ´é¢ãŒå¤šã„
- ã‚‚ã¨ã‚‚ã¨ã€x ã‚’ã¨ã¦ã‚‚å°ã•ãªå€¤ã‚’, log åŒ–ã—ã¦ã‚‹ã®ã§ã€æ¡è½ã¡ã¨ã‹ã—ã¦ã—ã¾ã†
- ä¾‹ãˆã°ã€ ã€xãŒ -30 ã¨ã‹ã ã¨ã€ exp(x)ã¯ã€ 0.000000000000000...ã¨ã‹ã§ã€exp ã§æˆ»ã—ã¦ã€ã•ã‚‰ã«è¶³ã—ç®—ã€log ã¨ã‹ã«ãªã‚‹ã¨ã‚ˆããªã„ã€‚
- ã¨ã„ã†ã“ã¨ã§ã€å¯¾æ•°ã¨ã£ãŸã‘ã©ã€ä¸­èº«ãŒã€ã‚ã‚‹é–¢æ•°ã®è¶³ã—ç®—ã¨ã„ã†ã¨ãã¯ã‚„ã£ã‹ã„ã€‚
- ãªã®ã§ã€ã†ã¾ãã€ logsumexp()ã—ã¦ãã‚Œã‚‹é–¢æ•°ãŒæ¬²ã—ã„ã€‚


- https://rdrr.io/cran/RBesT/src/R/log_sum_exp.R ã‹ã‚‰ã‚½ãƒ¼ã‚¹ã‚’æŠœç²‹
#+begin_src R
## å¯¾æ•°ã«å¤‰æ›ã—ãŸå°¤åº¦ã‚’ã€exp ã§ä¸€æ—¦å…ƒã«æˆ»ã—ã¦ã‹ã‚‰åˆè¨ˆã—ã€å†åº¦å¯¾æ•°ã«æˆ»ã™
log_sum_exp <- function(x) {
  if(length(x) == 1)
    return(x)
  xmax <- which.max(x)
  if (is.finite(x[xmax]))
    return(log1p(sum(exp(x[-xmax]-x[xmax])))+x[xmax])
  ## in case the maximum is not finite, we let R figure out what is
  ## the correct result (usually -Inf or +Inf)
  return(log(sum(exp(x))))
}

## åˆè¨ˆ1ã®ç¢ºç‡ãƒ™ã‚¯ãƒˆãƒ«ã«å¤‰æ›ã™ã‚‹
softmax <- function (x) {
  exp(x - log_sum_exp(x))
}
#+end_src

* å¾®åˆ†

#+begin_src R
# f(x) = x^2
f <- function(x) x ^ 2

# lim h -> 0 ã‚’ h -> 0.00001 ã§è¿‘ä¼¼ã™ã‚‹
diff_f <- function(f, x) {
  h <- 0.000001
  (f(x + h) - f(2)) / h
}
diff_f(f, 2) # 4.000001

D(expr(x ^ 2), "x") # => 2 * x
#+end_src

#+RESULTS:
: 
: [1] 4.000001
: 
: Error in expr(x^2) : could not find function "expr"

* ãƒ™ã‚¯ãƒˆãƒ«/è¡Œåˆ—
** ãƒ™ã‚¯ãƒˆãƒ«
*** å®šæ•°å€ = ã‚¹ã‚«ãƒ©ãƒ¼å€

#+begin_src R
c(2, 3, 4, 5) * 4
#+end_src

#+RESULTS:
: [1]  8 12 16 20

- ãƒ™ã‚¯ãƒˆãƒ«ã®é•·ã•ãŒç•°ãªã‚‹ã¨ãã¯ã€è‡ªå‹•çš„ã«è£œã£ã£ã¦ãã‚Œã‚‹ (å‰²ã‚Šåˆ‡ã‚Œã‚‹å ´åˆã¯)
#+begin_src R
c(2, 3, 4, 5) * c(4, 2)
#+end_src

#+RESULTS:
: [1]  8  6  4 20
: Warning message:
: In c(2, 3, 4, 5) * c(4, 2, 1) :
:   longer object length is not a multiple of shorter object length

*** å†…ç© =%*%=

- è¦ç´ åŒæ™‚ã®æ›ã‘ç®—ã®å’Œ
#+begin_src R
va <- c(1, 2, 3, 4, 5)
vb <- c(2, 4, 6, 8, 10)

va %*% vb
sum(va * vb)
#+end_src

#+RESULTS:
: 
:      [,1]
: [1,]  110
: 
: [1] 110

*** å¤–ç© =%o%=

#+begin_src R
va %o% vb
#+end_src

#+RESULTS:
:      [,1] [,2] [,3] [,4] [,5]
: [1,]    2    4    6    8   10
: [2,]    4    8   12   16   20
: [3,]    6   12   18   24   30
: [4,]    8   16   24   32   40
: [5,]   10   20   30   40   50

** è¡Œåˆ—
*** è¡Œåˆ—ã®ç© =%*%=

- è¡Œåˆ— A ã®åˆ—æ•°ã¨è¡Œåˆ— B ã®è¡Œæ•°ãŒä¸€è‡´ã—ã¦ã„ã‚‹å¿…è¦ã‚ã‚Š
#+begin_src R
mata <- matrix(3:8, ncol = 2)
mata
matb <- matrix(1:6, ncol = 3)
matb

mata %*% matb
#+end_src

#+RESULTS:
#+begin_example

     [,1] [,2]
[1,]    3    6
[2,]    4    7
[3,]    5    8

     [,1] [,2] [,3]
[1,]    1    3    5
[2,]    2    4    6

     [,1] [,2] [,3]
[1,]   15   33   51
[2,]   18   40   62
[3,]   21   47   73
#+end_example

*** è»¢ç½® =t()=

#+begin_src R
mata
t(mata)
#+end_src

#+RESULTS:
:      [,1] [,2]
: [1,]    3    6
: [2,]    4    7
: [3,]    5    8
: 
:      [,1] [,2] [,3]
: [1,]    3    4    5
: [2,]    6    7    8

*** æ­£æ–¹è¡Œåˆ—

- è¡Œæ•°ã¨åˆ—æ•°ãŒç­‰ã—ã„è¡Œåˆ—
#+begin_src R
matrix(1:9, ncol = 3, nrow = 3)
#+end_src

#+RESULTS:
:      [,1] [,2] [,3]
: [1,]    1    4    7
: [2,]    2    5    8
: [3,]    3    6    9

- ä¸Šä¸‰è§’è¡Œåˆ—
  - å¯¾è§’ã‚ˆã‚Šã‚‚ä¸‹ã®æˆåˆ†ãŒå…¨ã¦ã‚¼ãƒ­ã®è¡Œåˆ—
  - å³ä¸‰è§’ã¨ã‚‚è¨€ã†

- ä¸‹ä¸‰è§’è¡Œåˆ—
  - å¯¾è§’ã‚ˆã‚Šã‚‚ä¸Šã®æˆåˆ†ãŒå…¨ã¦ã‚¼ãƒ­ã®è¡Œåˆ—
  - å·¦ä¸‰è§’ã¨ã‚‚è¨€ã†

*** å¯¾è§’è¡Œåˆ—/å˜ä½è¡Œåˆ— =diag()=

- éå¯¾è§’è¦ç´ ã¯ã€å…¨ã¦ã‚¼ãƒ­
#+begin_src R
diag(c(1, 2, 3))
#+end_src

#+RESULTS:
:      [,1] [,2] [,3]
: [1,]    1    0    0
: [2,]    0    2    0
: [3,]    0    0    3

- å˜ä½è¡Œåˆ—
- å¯¾è§’è¡Œåˆ—ã®è¦ç´ ãŒå…¨ã¦ 1
#+begin_src R
diag(3)
#+end_src

#+RESULTS:
:      [,1] [,2] [,3]
: [1,]    1    0    0
: [2,]    0    1    0
: [3,]    0    0    1

- _å˜ä½è¡Œåˆ—ã‚’ã‹ã‘ã¦ã‚‚å€¤ã¯å¤‰ã‚ã‚‰ãªã„_
#+begin_src R
matc <- matrix(1:9, ncol = 3)
matc
matc %*% diag(3)
#+end_src

#+RESULTS:
#+begin_example

     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9

     [,1] [,2] [,3]
[1,]    1    4    7
[2,]    2    5    8
[3,]    3    6    9
#+end_example

*** è¡Œåˆ—å¼ =det()=

- det()é–¢æ•°ã§è¨ˆç®—
- æ­£æ–¹è¡Œåˆ—ã®ã¿ãŒè¡Œåˆ—å¼ã‚’æŒã¤
- è¡Œåˆ—å¼ã¯ã€é€†è¡Œåˆ—ãŒãã‚‚ãã‚‚å­˜åœ¨ã™ã‚‹ã®ã‹ã‚’ç¢ºèªã™ã‚‹ã“ã¨ãŒã§ãã‚‹
  => è¡Œåˆ—å¼ãŒ 0 ã ã¨é€†è¡Œåˆ—ã‚’æŒãŸãªã„
  
#+begin_src R
mate <- matrix(c(1, 0.5, 0.5, 0.5, 1, 0.5, 0.5, 0.5, 1), ncol = 3)
mate
det(mate)
#+end_src

#+RESULTS:
: 
:      [,1] [,2] [,3]
: [1,]  1.0  0.5  0.5
: [2,]  0.5  1.0  0.5
: [3,]  0.5  0.5  1.0
: 
: [1] 0.5

*** é€†è¡Œåˆ— =solve()=

- é€†è¡Œåˆ—ã¨ã¯ã€ã‚ã‚‹è¡Œåˆ—ã«ã‹ã‘ã‚‹ã“ã¨ã§ã€ãã®è¡Œåˆ—ã‚’å˜ä½è¡Œåˆ—ã«ã—ã¦ã—ã¾ã†è¡Œåˆ—ã®ã“ã¨
- é€£ç«‹ 1 æ¬¡æ–¹ç¨‹å¼ã‚’ä¸€ç¬ã§è§£ãã“ã¨ãŒã§ãã‚‹ï¼ˆğ‘¥=ğ´âˆ’1ğ‘ï¼‰ãªã©ã€è¡Œåˆ—ã‚’è¨ˆç®—ã™ã‚‹ä¸Šã§éå¸¸ã«æœ‰ç›Šã‹ã¤é‡è¦

#+begin_src R
mate_i <- solve(mate)
mate_i

mate %*% mate_i
#+end_src

#+RESULTS:
#+begin_example

     [,1] [,2] [,3]
[1,]  1.5 -0.5 -0.5
[2,] -0.5  1.5 -0.5
[3,] -0.5 -0.5  1.5

              [,1] [,2] [,3]
[1,]  1.000000e+00    0    0
[2,] -5.551115e-17    1    0
[3,] -1.110223e-16    0    1
#+end_example

*** é€£ç«‹æ–¹ç¨‹å¼ã®è¡Œåˆ—è§£ =solve()=

- é€£ç«‹æ–¹ç¨‹å¼
$2x + 3y = 1$
$5x + y = 3$

è¡Œåˆ—è¡¨ç¤ºã«ã™ã‚‹ã¨ã€ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ã‘ã‚‹
$\begin{pmatrix} 2 & 3 \\ 5 & 1 \end{pmatrix} \begin{pmatrix} x \\ y \end{pmatrix} = \begin{pmatrix} 1 \\ 3 \end{pmatrix}$

#+begin_src R
mat <- matrix(c(2, 5, 3, 1), ncol = 2)
ans <- c(1, 3)
mat
ans
#+end_src

#+RESULTS:
:      [,1] [,2]
: [1,]    2    3
: [2,]    5    1
: [1] 1 3

é€†è¡Œåˆ—
$\begin{pmatrix} 2 & 3 \\ 5 & 1 \end{pmatrix}^{-1}$
ã‚’æ±‚ã‚ãŸã„

ãã®ãŸã‚ã«ã€è¡Œåˆ—å¼ã‚’æ±‚ã‚ã‚‹ (è¡Œåˆ—å¼ãŒ 0 ã ã¨é€†è¡Œåˆ—ã‚’æŒãŸãªã„)
$|A|$

#+begin_src R
A <- 2 * 1 - 5 * 3
A
det(mat) # æ¤œç®—
#+end_src

#+RESULTS:
: [1] -13
: [1] -13

è¡Œåˆ—å¼ãŒã€ç®—å‡ºã§ããŸã‚‰ã€é€†è¡Œåˆ—ã¯ä»¥ä¸‹ã§æ±‚ã‚ã‚‰ã‚Œã‚‹
$\begin{pmatrix} 2 & 3 \\ 5 & 1 \end{pmatrix}^{-1} = \frac{1}{|A|} \begin{pmatrix} 1 & -3 \\ -5 & 2 \end{pmatrix}$

#+begin_src R
inv <- (1/A) * matrix(c(1, -5, -3, 2), ncol = 2)
inv
solve(mat) # æ¤œç®—
#+end_src

#+RESULTS:
:             [,1]       [,2]
: [1,] -0.07692308  0.2307692
: [2,]  0.38461538 -0.1538462
:             [,1]       [,2]
: [1,] -0.07692308  0.2307692
: [2,]  0.38461538 -0.1538462

ã“ã‚Œã§ã€é€£ç«‹æ–¹ç¨‹å¼ã‚’ã¨ã
$\begin{pmatrix} x \\ y \end{pmatrix} = \begin{pmatrix} 2 & 3 \\ 5 & 1 \end{pmatrix}^{-1} \begin{pmatrix} 1 \\ 3 \end{pmatrix}$

#+begin_src R
inv %*% ans
solve(mat, ans) # æ¤œç®—
#+end_src

#+RESULTS:
:             [,1]
: [1,]  0.61538462
: [2,] -0.07692308
: [1]  0.61538462 -0.07692308

- [[http://cse.naro.affrc.go.jp/takezawa/r-tips/r/20.html][20. è¡Œåˆ—è¨ˆç®—]] ã®ä¾‹
#+begin_src R
a <- matrix(c(0,1,2,3,4,5,6,7,9), 3,3) #      3y + 6z =  1
b <- matrix(c(1,0,-2))                 #  x + 4y + 7z =  0
                                       # 2x + 5y + 9z = -2

a
b
solve(a,b)
#+end_src

#+RESULTS:
#+begin_example
     [,1] [,2] [,3]
[1,]    0    3    6
[2,]    1    4    7
[3,]    2    5    9
     [,1]
[1,]    1
[2,]    0
[3,]   -2
          [,1]
[1,] -2.333333
[2,]  2.333333
[3,] -1.000000
#+end_example

*** å›ºæœ‰å€¤/å›ºæœ‰å€¤ãƒ™ã‚¯ãƒˆãƒ« =eigen()=

- eigen value = å›ºæœ‰å€¤
- eigen vector = å›ºæœ‰å€¤ãƒ™ã‚¯ãƒˆãƒ«
#+begin_src R
eigen(mate)
#+end_src

#+RESULTS:
: eigen() decomposition
: $values
: [1] 2.0 0.5 0.5
: 
: $vectors
:            [,1]       [,2]       [,3]
: [1,] -0.5773503  0.0000000  0.8164966
: [2,] -0.5773503 -0.7071068 -0.4082483
: [3,] -0.5773503  0.7071068 -0.4082483

*** ã‚¢ãƒ€ãƒãƒ¼ãƒ«ç© (Hadamard Product) / ã‚¯ãƒ­ãƒãƒƒã‚«ãƒ¼ç©

_ã‚¢ãƒ€ãƒãƒ¼ãƒ«ç©_
- åŒã˜ã‚µã‚¤ã‚ºã®è¡Œåˆ—ã«å¯¾ã—ã¦ã€æˆåˆ†æ¯ã«ç©ã‚’ã¨ã‚‹ã“ã¨ã«ã‚ˆã£ã¦å®šã¾ã‚‹è¡Œåˆ—ã®ç©
- Element-wise product

åŒã˜ã‚µã‚¤ã‚º m x n ã® 2 ã¤ã®è¡Œåˆ— $A = (a_{i,j}), B = (b_{i,j})$ ã®ã‚¢ãƒ€ãƒãƒ¼ãƒ«ç©

$A \odot B = (a_{i,j} \cdot b_{i.j})$

#+begin_src R
A <- matrix(seq(1,9,1), 3)
B <- matrix(seq(1,9,1), 3)

A * B # ã‚¢ãƒ€ãƒãƒ¼ãƒ«ç©
#+end_src

#+RESULTS:
: 
:      [,1] [,2] [,3]
: [1,]    1   16   49
: [2,]    4   25   64
: [3,]    9   36   81


_ã‚¯ãƒ­ãƒãƒƒã‚«ãƒ¼ç©_

#+begin_src R
A <- matrix(seq(1,9,1), 3)
B <- matrix(seq(1,9,1), 3)

A %x% B # ã‚¯ãƒ­ãƒãƒƒã‚«ãƒ¼ç©
#+end_src

#+RESULTS:
#+begin_example

      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9]
 [1,]    1    4    7    4   16   28    7   28   49
 [2,]    2    5    8    8   20   32   14   35   56
 [3,]    3    6    9   12   24   36   21   42   63
 [4,]    2    8   14    5   20   35    8   32   56
 [5,]    4   10   16   10   25   40   16   40   64
 [6,]    6   12   18   15   30   45   24   48   72
 [7,]    3   12   21    6   24   42    9   36   63
 [8,]    6   15   24   12   30   48   18   45   72
 [9,]    9   18   27   18   36   54   27   54   81
#+end_example

* éšä¹—!

#+begin_src R
factorial(5) # 5!
#+end_src

#+RESULTS:
: [1] 120

* é †åˆ— (Permutation)

- é‡è¤‡ãªãä¸¦ã¹ã‚‹å ´åˆã®æ•°
- base package ã«ã¯ãªã„

#+begin_src R
# n å€‹ã®å¯¾è±¡ã‹ã‚‰ã€rå€‹ã‚’é‡è¤‡ãªãä¸¦ã¹ã‚‹é †åˆ—ã®æ•° = nPr = n! / (n - r)!
n <- 3
r <- 2
factorial(n) / factorial(n - r)

e1071::permutations(3)
#+end_src

#+RESULTS:
#+begin_example

[1] 6

     [,1] [,2] [,3]
[1,]    1    2    3
[2,]    2    1    3
[3,]    2    3    1
[4,]    1    3    2
[5,]    3    1    2
[6,]    3    2    1
#+end_example

* çµ„ã¿åˆã‚ã› (Combination)
- é‡è¤‡ãªãé¸ã¶å ´åˆã®æ•°
- é †ç•ªã¯å•ã‚ãªã„
- nCr = n! / r!(n - r)!

#+begin_src R
n <- 5
r <- 3
factorial(n) / (factorial(3) * factorial(n - r))
choose(n, r) # çµ„ã¿åˆã‚ã›ã®æ•°
combn(n, r)  # çµ„ã¿åˆã‚ã›ã‚’ matrix è¡¨ç¤º
#+end_src

#+RESULTS:
: 
: [1] 10
: 
: [1] 10
: 
:      [,1] [,2] [,3] [,4] [,5] [,6] [,7] [,8] [,9] [,10]
: [1,]    1    1    1    1    1    1    2    2    2     3
: [2,]    2    2    2    3    3    4    3    3    4     4
: [3,]    3    4    5    4    5    5    4    5    5     5
* å‚è€ƒ

- è¡Œåˆ—
  - [[http://cse.naro.affrc.go.jp/takezawa/r-tips/r/20.html][20. è¡Œåˆ—è¨ˆç®—]]
  - [[https://stats.biopapyrus.jp/r/basic/matrix.html][R ã«ã‚ˆã‚‹è¡Œåˆ—ã®æ¼”ç®—@biostatistics
]]
- [[https://qiita.com/advent-calendar/2016/math_for_ml][æ©Ÿæ¢°å­¦ç¿’ã«å¿…è¦ãªé«˜æ ¡æ•°å­¦ã‚„ã‚Šç›´ã—ã‚¢ãƒ‰ãƒ™ãƒ³ãƒˆã‚«ãƒ¬ãƒ³ãƒ€ãƒ¼ Advent Calendar 2016]]
